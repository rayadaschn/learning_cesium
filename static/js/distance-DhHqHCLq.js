import{b as e,d as t,h as i,_ as a,u as n,r as s,o,c as r,a as u,w as l,g as c}from"./index-DLeBNJnQ.js";function d(a){const n=e(null),s=e(a);t((()=>{a instanceof Cesium.Viewer&&(n.value=new Cesium.CustomDataSource("measureLayer"),s.value.dataSources.add(n.value))})),i((()=>{n.value&&a&&s.value.dataSources.remove(n.value)}));const o=e=>e.map((e=>(e=>{const t=Cesium.Ellipsoid.WGS84.cartesianToCartographic(e);return{longitude:Cesium.Math.toDegrees(t.longitude),latitude:Cesium.Math.toDegrees(t.latitude),altitude:t.height}})(e))),r=e=>{const{longitude:t,latitude:i,altitude:a}=e;return Cesium.Cartographic.fromDegrees(t,i,a)},u=e=>{const t=s.value.scene.pickPosition(e),i=Cesium.Cartographic.fromCartesian(t);i.height+=20;return Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,i.height)};return{drawLineMeasureGraphics:(e={})=>{var t;const{callback:i,width:a,material:l}=e,c=[];let d;const C=new Cesium.ScreenSpaceEventHandler(s.value.scene.canvas),m=e=>{var t;const i=(e=>{if(e.length<2)return"0.000";let t=0;const i=new Cesium.EllipsoidGeodesic;for(let a=0;a<e.length-1;a++){const n=r(e[a]),s=r(e[a+1]);i.setEndPoints(n,s);let o=i.surfaceDistance;o=Math.sqrt(Math.pow(o,2)+Math.pow(s.height-n.height,2)),t+=o}return t.toFixed(3)})(o(c)),a=(Number(i)/1e3).toFixed(3),s=Number(a)>1?`${a} 公里`:`${i} 米`,u=Cesium.Cartographic.fromCartesian(e);u.height+=.1;const l=Cesium.Cartesian3.fromRadians(u.longitude,u.latitude,u.height),d=new Cesium.Entity({position:l,point:{pixelSize:8,outlineColor:Cesium.Color.BLUE,outlineWidth:8},label:{text:s,show:!0,showBackground:!0,backgroundColor:new Cesium.Color(0,0,0,.5),font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-20,-20)}});null==(t=n.value)||t.entities.add(d)};C.setInputAction((e=>{const t=u(e.position);t&&t.x&&(0===c.length&&c.push(t.clone()),m(t),c.push(t))}),Cesium.ScreenSpaceEventType.LEFT_CLICK),C.setInputAction((e=>{const t=u(e.endPosition);c.length>=2&&t&&t.x&&(c.pop(),c.push(t))}),Cesium.ScreenSpaceEventType.MOUSE_MOVE),C.setInputAction((e=>{C.destroy();const t=u(e.position);m(t),"function"==typeof i&&i(o(c),d)}),Cesium.ScreenSpaceEventType.RIGHT_CLICK);const p=new Cesium.Entity({polyline:{width:a??10,material:l||new Cesium.PolylineArrowMaterialProperty(Cesium.Color.BLUE),positions:new Cesium.CallbackProperty((()=>c),!1)}});d=null==(t=n.value)?void 0:t.entities.add(p)},transformWGS84ToCartesian:e=>{const{longitude:t,latitude:i,altitude:a}=e;return Cesium.Cartesian3.fromDegrees(t,i,a,Cesium.Ellipsoid.WGS84)}}}const C={class:"container"},m=a({__name:"distance",setup(e){const t=n().viewer;t.camera.setView({destination:Cesium.Cartesian3.fromDegrees(120.153576,30.287459,3e3)});const{drawLineMeasureGraphics:i}=d(t),a=()=>{i()};return(e,t)=>{const i=s("el-button");return o(),r("div",C,[u(i,{type:"primary",onClick:a},{default:l((()=>[c("空间距离")])),_:1})])}}},[["__scopeId","data-v-e2eba5dc"]]);export{m as default};
